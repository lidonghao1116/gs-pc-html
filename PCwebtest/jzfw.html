<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="css/head-foot.css" rel="stylesheet" type="text/css" />
<link href="css/jzfw.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.11.3.min.js" type="text/javascript"></script>
<script type="text/javascript" src="js/top.js"></script>
<script type="text/javascript" src="js/jzfw.js"></script>
<script type="text/javascript" src="js/jquery.pagination.js"></script>
<title>家政服务</title>
</head>
<body>
	<!--头部-->
	<div class="head_box">
		<div class="head">
			<div class="left logo">
				<a  target="_self">
					<img src="img/logo0.png"/>
				</a>
			</div>
			<div class="left more_s">
				<select>
					<option>更多导航</option>
					<option>更多导航0</option>
					<option>更多导航1哈</option>
				</select>
			</div>
			<div class="right head_r">
				<ul>
					<li><a >登录</a></li>
					<li><a >退出</a></li>
					<li><a >我的预约</a></li>
					<li><a >我的账户</a></li>
					<li class="wechat"><a>官网微信</a>
						<div class="wechat_b">
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="top_com_box">
		<div class="top_com">
		<a href="index.html">
				<div class="first_word"></div>
				<div class="top_com_l">
					<h1></h1>
					<p></p>
				</div>
			</a>
			<div class="top_com_r">
				<div class="phone"></div>
				<div class="nav">
					<ul>
						<li><a href="index.html" target="_self">首页</a></li>
						<li class="active"><a href="jzfw.html" target="_self">家政服务</a></li>
						<li><a href="serviceCustomize.html" target="_self">服务定制</a></li>
						<li><a href="train.html" target="_self">专业培训</a></li>
						<li><a href="job.html" target="_self">岗位招聘</a></li>
						<li><a href="about_us.html" target="_self">关于我们</a></li>
					<ul>
				</div>
			</div>
		</div>
	</div>
	<!--主要内容-->
	<div class="top_box">
		<div class="main_content">
			<h2 class="title_h2">服务工种</h2>
			<div class="menu">
				<div class="menu_left left">
					<ul>
					</ul>
				</div>
				<div class="menu_right left">
					<div class="menu_rtop">
						<ul>
							<li><span>服务对象：</span><p class="duixiang" id="object"></p></li>
							<li><span>服务内容：</span><p class="neirong" id="content"></p></li>
						</ul>
					</div>
					<div class="menu_runder">
						<div class="select_list">
							<p class="select_label">价格：</p>
							<ul id="salaryType" class="choose_ul_sp clearfix list3">
							</ul>
							<div class="tab_content">
								<ul class="choose_ul clearfix" id="salaryMonth">
								</ul>
								<ul class="choose_ul clearfix" id="salaryDay">
								</ul>
								<ul class="choose_ul clearfix" id="salaryHour">
								</ul>
							</div>
								<!-- <ul class="list3 clearfix">
									<li class="active" data-salary="">不限</li>
								</ul> -->
						</div>
						<div class="select_list">
							<p class="select_label">经验：</p>
								<ul class="list1 choose_ul clearfix">
									<li class="active" data-experience="">不限</li>
								</ul>
						</div>
						<div class="select_list no_border_bottom">
							<p class="select_label">年龄：</p>
								<ul class="choose_ul list2 clearfix">
									<li class="active" data-age="">不限</li>
								</ul>
						</div>
						<div class="select_list hide_li" style="display:none;">
							<p class="select_label">属相：</p>
								<ul class="choose_ul zodiac clearfix">
									<li class="active" data-zodiac="">不限</li>
								</ul>
						</div>
						<div class="select_list hide_li" style="display:none;">
							<p class="select_label">学历：</p>
								<ul class="choose_ul education clearfix">
									<li class="active" data-education="">不限</li>
								</ul>
						</div>
						<div class="select_list hide_li choose_list_l" style="display:none;">
							<p class="select_label">籍贯：</p>
								<ul class="choose_ul nativePlace clearfix">
									<li class="active" data-nativePlace="">不限</li>
								</ul>
								<span class="more">更多</span>
						</div>
						<div class="up"><span>展开</span><img src="img/up.png"/></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="per_content">
		<div class="per_list">
			<ul id="staffList">
				<li>
					<div class="card">
						<div class="img_box">
							<img src="img/photo.png">
						</div>
						<h1><span>张阿姨</span>钟点工、保姆</h1>
						<h2>￥5000元/月</h2>
						<p>30岁&nbsp;|&nbsp;属羊&nbsp;|&nbsp;上海人&nbsp;|&nbsp;处女座&nbsp;|&nbsp;高中</p>
					</div>
				</li>
			</ul>
		</div>
		<div id="pagination">

		</div>
	</div>
	<!--底部-->
	<!-- <div class="foot_box">
		<div class="foot">Copyright@2016上海家策教育科技有限公司<a href="http://www.miitbeian.gov.cn" target="_blank">沪ICP备16022947号-1</a></div>
	</div> -->
	<iframe scrolling="no" src="footer.html" width="100%" frameborder="0" height="270px"></iframe>
	<div class="bottom_fixed">
		<div class="bottom_fixed_link">
			<img class="top_img" src="img/qqren.png"/>
			<div class="link_phone">
				<p>服务热线</p>
				<p>021-6666&nbsp;&nbsp;8888</p>
			</div>
			<div class="qq_link">
				<p>QQ交谈</p>
				<p>QQ交谈</p>
				<p>QQ交谈</p>
			</div>
			<div class="lin_wechat">
			</div>
		</div>
		<div id="goTopBtn" class="back_top">返回顶部</div>
	</div>
</body>
<script type="text/javascript">
//截取url后面的参数
function GetRequest(){
var url = location.search; //获取url中"?"符后的字串
var theRequest = new Object();
if (url.indexOf("?") != -1) {
  var str = url.substr(1);
  strs = str.split("&");
  for(var i = 0; i < strs.length; i ++) {
     theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
  }
}
return theRequest;
}
	var pageNumber = 1;
	var pageSize = 8;
	function pagination(records){
		$("#pagination").pagination(records, {
		    num_edge_entries: 1,
		    num_display_entries: 4,
		    current_page:pageNumber-1,
		    items_per_page:pageSize,
		    prev_text:"上一页",
		    next_text:"下一页",
		    callback: page_index
		});
	};

	function page_index(page_index){
		var pageNumber = page_index+1;
		var serviceItemCode=$(".menu_left ul li.active").attr("data-serCode");
	    var experience=$(".list1 li.active").attr("data-experience");
		var age=$(".list2 li.active").attr("data-age");
		var unit=$(".list3 li.active").attr("data-sercode");
		var price="";
        if($(".tab_content ul li.active").length>0){
            price=$(".tab_content ul li.active").attr("data-sercode");
        }
		var zodiac=$(".zodiac li.active").attr("data-zodiac");
		var education=$(".education li.active").attr("data-education");
		var nativePlace=$(".nativePlace li.active").attr("data-nativePlace");
		StaffPersonInfoList(pageNumber,pageSize,serviceItemCode,experience,age,price,unit,zodiac,education,nativePlace);
	};
	function StaffPersonInfoList(pageNumber,pageSize,serviceItemCode,experience,age,price,unit,zodiac,education,nativePlace){
	$.ajax({
		url: publicPath+"/api/houseKeeping/StaffPersonInfoList",
		type: "post",
		data: {
			pageNumber:pageNumber,
			pageSize:pageSize,
			itemCode:serviceItemCode,
			servicePrice:price,
			unit:unit,
			experence:experience,
			age:age,
			zodiac:zodiac,
			education:education,
			nativePlace:nativePlace
			},
		dataType: "json",
		async:false,
		success: function success(data) {
			if(data.success) {
				if(data.code==0){
					var dataJD=data.jsonData.rows;
					if(data.jsonData.records==0){
                		$("#pagination").css("display","none");
                	}else{
                		$("#pagination").css("display","block");
					}
					if(dataJD!="" && dataJD!=null){
						var html=""
						$.each(dataJD, function(i,item) {
							var workExperience="";
							if(item.experience.split(",").length==2 && item.experience.split(",")[1]!=""){
								workExperience=item.experience.split(",")[1]+"年";
							}else{
								workExperience=item.experience.split(",")[0]+"年以上";
							}
							var staffName="";
							if(item.sex=="01"){
								staffName=item.staffName.split("")[0]+"师傅";
							}else if(item.sex=="02"){
								staffName=item.staffName.split("")[0]+"阿姨";
							}
							var servicePriceUnit="";
							if(item.servicePriceUnit=="01"){
								servicePriceUnit="元/月";
							}else if(item.servicePriceUnit=="02"){
								servicePriceUnit="元/小时";
							}else if (item.servicePriceUnit=="03") {
								servicePriceUnit="元/26天";
							}else if (item.servicePriceUnit=="04") {
								servicePriceUnit="元/天";
							}
							html+="<li data-staffId='"+item.staffId+"'>"+
									"<div class='card'>"+
										"<div class='img_box'>"+
											"<img src='"+item.headImage+"'>"+
										"</div>"+
										"<h1><span>"+staffName+"</span>"+item.serviceItemName+"</h1>"+
										"<h2>"+RetainedDecimalPlacesNF(item.price)+servicePriceUnit+"</h2>"+
										"<p>"+item.age+"岁&nbsp;|&nbsp;属"+item.zodiac+"&nbsp;|&nbsp;"+item.nativePlace+"人&nbsp;|&nbsp;"+item.constellation+"&nbsp;|&nbsp;"+item.education+"</p>"+
									"</div>"+
								"</li>";
						});
					$("#staffList").html(html);
					}else{
					$("#staffList").html("<div class='no_found'><p>没有找到家政员~</p></div>");
					}
					
				}
			} else {
				console.log(data.msg);
			}
		},
		error: function(err) {
			console.log(err);
		}
	});
	}
	//加载内容
    function content(serviceItemCode){
    	//背景图加载
    	if(serviceItemCode=="01"){
			$(".menu_rtop").css("background-image","url(img/yuesao.png)");
		}
    	if(serviceItemCode=="02"){
			$(".menu_rtop").css("background-image","url(img/yuying.png)");
		}
		if(serviceItemCode=="03"){
			$(".menu_rtop").css("background-image","url(img/baomu.png)");
		}
		if(serviceItemCode=="04"){
			$(".menu_rtop").css("background-image","url(img/yanglao.png)");
		}
		if(serviceItemCode=="05"){
			$(".menu_rtop").css("background-image","url(img/zhongdian.png)");
		}
		if(serviceItemCode=="06"){
			$(".menu_rtop").css("background-image","url(img/jiating.png)");
		}
		if(serviceItemCode=="07"){
			$(".menu_rtop").css("background-image","url(img/hugong.png)");
		}
				$.ajax({
					url: publicPath+"/api/houseKeeping/objectContent",
					type: "post",
					data: {itemCode:serviceItemCode},
					dataType: "json",
					success: function success(data) {
						if(data.success) {
							if(data.code==0){
								dataJD=data.jsonData;
								$("#object").html(dataJD.serviceObject);
								$("#content").html(dataJD.serviceContent);
							}
						} else {
							console.log(data.msg);
						}
					},
					error: function(err) {
						console.log(err);
					}
				});
				
				//加载员工列表信息
				$.ajax({
					url: publicPath+"/api/houseKeeping/StaffPersonInfoList",
					type: "post",
					data: {pageNumber:pageNumber,pageSize:pageSize,itemCode:serviceItemCode},
					dataType: "json",
					async:false,
					success: function success(data) {
						if(data.success) {
							if(data.code==0){
								dataJD=data.jsonData;
								pagination(dataJD.records);
								console.log(data.msg);
							}
						} else {
							console.log(data.msg);
						}
					}
				});
		   }
	$(function(){
		var objct=GetRequest();
		var serviceCode=objct.serviceCode;
		//学历加载
		$.ajax({
				url: publicPath+"/api/common/getDictionaryData/c012",
				type: "post",
				data: {},
				dataType: "json",
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							var dataJD=data.jsonData;
							var html=""
							$.each(dataJD, function(i,item) {
								html+="<li data-education='"+item.code+"'>"+item.name+"</li>"
							});
							$(".education").append(html);
						}
					} else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});
		//属相加载
		$.ajax({
				url: publicPath+"/api/common/getDictionaryData/c009",
				type: "post",
				data: {},
				dataType: "json",
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							var dataJD=data.jsonData;
							var html=""
							$.each(dataJD, function(i,item) {
								html+="<li data-zodiac='"+item.code+"'>"+item.name+"</li>"
							});
							$(".zodiac").append(html);
						}
					} else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});
	//薪资
    $.ajax({
            url: publicIndex + "/fbeeWebConsole_web/api/custServer/getServiceIncome",
            type: "post",
            data: {},
            dataType: "json",
            async: false,
            success: function success(data) {
                if (data.success) {
                    dataJD=data.jsonData;
                    var html="<li class='active' data-sercode=''>不限</li>";
                    $.each(dataJD,function(i,item){
                        html+="<li data-sercode='"+item.id+"'>"+item.value+"</li>";
                        var dataPrie= item.ceList;
                        var html0="";
                        $.each(dataPrie,function(j,item0){
                            html0+="<li data-sercode='"+item0.id+"'>"+item0.value+"</li>";
                        })
                        $(".tab_content ul").eq(i).html(html0);
                    });
                    $("#salaryType").html(html); 
                } else {
                    console.log(data.msg);
                }
            },
            error: function(err) {
                console.log(err);
            }
        });
		//籍贯加载
		$.ajax({
				url: publicPath+"/api/common/getDictionaryData/c010",
				type: "post",
				data: {},
				dataType: "json",
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							var dataJD=data.jsonData;
							var html=""
							$.each(dataJD, function(i,item) {
								html+="<li data-nativePlace='"+item.code+"'>"+item.name+"</li>"
							});
							$(".nativePlace").append(html);
						}
					} else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});
		//经验选择
			$.ajax({
				url: publicPath+"/api/common/getDictionaryData/c007",
				type: "post",
				data: {},
				dataType: "json",
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							var dataJD=data.jsonData;
							var html=""
							$.each(dataJD, function(i,item) {
								html+="<li data-experience='"+item.code+"'>"+item.name.replace(",","-")+"年"+"</li>";
							});
							$(".list1").append(html);
							$(".list1 li").eq(1).html(dataJD[0].name.split(",")[1]+"年以下");
							$(".list1 li").eq(dataJD.length).html(dataJD[dataJD.length-1].name.split(",")[0]+"年以上");
						}
					} else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});
			//年龄选择
			$.ajax({
				url: publicPath+"/api/common/getDictionaryData/c008",
				type: "post",
				data: {},
				dataType: "json",
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							var dataJD=data.jsonData;
							var html=""
							$.each(dataJD, function(i,item) {
								html+="<li data-age='"+item.code+"'>"+item.name.replace(",","-")+"岁"+"</li>"
							});
							$(".list2").append(html);
							$(".list2 li").eq(1).html(dataJD[0].name.split(",")[1]+"岁以下");
							$(".list2 li").eq(dataJD.length).html(dataJD[dataJD.length-1].name.split(",")[0]+"岁以上");
						}
					} else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});
		//服务工种加载
		$.ajax({
				url: publicPath+"/api/houseKeeping/serviceItems",
				type: "post",
				data: {},
				dataType: "json",
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							dataJD=data.jsonData;
							var html=""
							//var count=0;
							for(var i=0;i<7;i++){
								if(dataJD[i]){
									var item = dataJD[i];
									html+="<li data-serCode='"+item.serviceItemCode+"'>"+item.serviceItemName+
									"</li>";
								}else{
									html+="<li></li>";
								}
							}

						/* 	$.each(dataJD, function(i,item) {
								html+="<li data-serCode='"+item.serviceItemCode+"'>"+item.serviceItemName+
								"</li>";
								count++;
							});
							var j = 6-count;
							if(j>0){
								for(;j>0;j--){
								html+="<li></li>";
								}
							}; */
							$(".menu_left ul").html(html);
							$(".menu_left ul li:first-child").addClass("active");
							if(serviceCode!=null&&serviceCode!=""){
								$(".menu_left ul li").each(function(){
									if(serviceCode==$(this).attr("data-serCode")){
										$(this).addClass("active");
										$(this).siblings().removeClass("active");
									}
								})
							}

							//服务内容与对象加载
							var  serviceItemCode=$(".menu_left ul li.active").attr("data-serCode");
							content(serviceItemCode);
					     }
					}
						else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});

	
		   $(".more").click(function() {
            if ($(this).hasClass("more_sp")) {
                $(this).removeClass("more_sp").text("更多");
                $(".choose_list_l").css("height", "46px");
            } else {
                $(this).addClass("more_sp").text("收起");
                $(".choose_list_l").css("height", "auto");

            }

		});
		$(".up").click(function(){
			if($(this).hasClass("active")){
				$(this).removeClass("active");
				$(".select_list:gt(2)").hide();
				$(".select_list").eq("2").addClass("no_border_bottom");
				$(".up span").text("展开");
			}
			else{
				$(this).addClass("active");
				$(".select_list:gt(2)").show();
				$(".up span").text("收起");
				$(".select_list").eq("2").removeClass("no_border_bottom");
			}
		})
	});
	//筛选项初始化
	function init(){
		$(".select_list ul li").removeClass("active");
		$(".select_list ul li:first-child").addClass("active");
		$(".tab_content ul li").removeClass("active");
		$(".up").removeClass("active");
		$(".hide_li").hide();
		$(".up span").text("展开");
	}
	//点击加载内容
	$(".menu_left ul").on("click","li",function(){
		$(this).addClass("active");
		$(this).siblings().removeClass("active");
		var serviceItemCode=$(this).attr("data-serCode");
		init();
		content(serviceItemCode);
		});
	function condition(){
		var serviceItemCode=$(".menu_left ul li.active").attr("data-serCode");
	    var experience=$(".list1 li.active").attr("data-experience");
		var age=$(".list2 li.active").attr("data-age");
		// var price=$(".tab_content ul li.active").attr("data-sercode");
		var unit=$(".list3 li.active").attr("data-sercode");
		var price="";
        if($(".tab_content ul li.active").length>0){
            price=$(".tab_content ul li.active").attr("data-sercode");
        }
		var zodiac=$(".zodiac li.active").attr("data-zodiac");
		var education=$(".education li.active").attr("data-education");
		var nativePlace=$(".nativePlace li.active").attr("data-nativePlace");
		//总数
			$.ajax({
				url: publicPath+"/api/houseKeeping/StaffPersonInfoList",
				type: "post",
				data: {
					itemCode:serviceItemCode,
					experence:experience,
					age:age,
					servicePrice:price,
					unit:unit,
					zodiac:zodiac,
					education:education,
					nativePlace:nativePlace
				},
				dataType: "json",
				async:false,
				success: function success(data) {
					if(data.success) {
						if(data.code==0){
							dataJD=data.jsonData;
							pagination(dataJD.records);
							console.log(data.msg);
						}
					} else {
						console.log(data.msg);
					}
				},
				error: function(err) {
					console.log(err);
				}
			});

	}
	//工作状态筛选
	/* $("input[name=status]").change(function(){
		condition();
	}) */
	// 筛选
	$(".select_list ul").on("click","li",function(){
		 if($(this).parent().hasClass("choose_ul")){
			 if($(this).parents().hasClass("tab_content")){
				$(".tab_content .choose_ul li").removeClass("active");
				$(this).siblings().removeClass("active");
				$(this).addClass("active");
			 }else{
            $(this).siblings().removeClass("active");
            $(this).addClass("active");
			 }
            
        }else if($(this).parent().hasClass("choose_ul_sp")){
            var $div_li = $(".choose_ul_sp li");
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
            var index = $div_li.index(this) - 1;
            if (index == -1) {
                $(".tab_content ul").hide();
                $(".tab_content .choose_ul li").removeClass("active");
            } else {
                $(".tab_content ul").eq(index).show().siblings("ul").hide();
                $(".tab_content ul").eq(index).siblings("ul").children("li").removeClass("active");
            }
        }
		
		condition();
		})

	
	//链接阿姨详情
	$("#staffList").on("click","li",function(){
		var staffId=$(this).attr("data-staffId");
		var serviceItemCode=$(".menu_left ul li.active").attr("data-serCode");
		location.href="jzfwxq.html?staffId="+staffId+"&serviceItemCode="+serviceItemCode;
	})



</script>
</html>
